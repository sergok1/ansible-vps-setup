---
# Пример файла переменных
# Скопируйте в main.yml и настройте под своё окружение
# cp main.yml.example main.yml

# ==============================================================================
# Настройка пользователя
# ==============================================================================
admin_user: "your_username"              # Имя пользователя для админа
admin_groups:
  - sudo
  - adm

# Путь к вашему SSH публичному ключу (на локальной машине)
ssh_public_key_path: "~/.ssh/id_ed25519.pub"

# ==============================================================================
# Hostname сервера
# ==============================================================================
# Hostname берётся из inventory (имя хоста в [vps] секции)
# Можно задать явно:
# server_hostname: "my-server"

# Устанавливать hostname автоматически
common_set_hostname: true

# ==============================================================================
# Настройка SSH
# ==============================================================================
ssh_port: 22                             # Кастомный SSH порт (измените с 22)
ssh_permit_root_login: "no"
ssh_password_authentication: "no"
ssh_pubkey_authentication: "yes"
ssh_max_auth_tries: 3
ssh_client_alive_interval: 300
ssh_client_alive_count_max: 2

# ==============================================================================
# Настройка файрвола UFW
# ==============================================================================
ufw_default_incoming_policy: "deny"
ufw_default_outgoing_policy: "allow"

# Порты для открытия (добавьте нужные порты)
# Формат: { port: "ПОРТ", proto: "tcp|udp", comment: "описание" }
ufw_allowed_ports:
  - { port: "{{ ssh_port }}", proto: "tcp", comment: "SSH" }
  # - { port: "80", proto: "tcp", comment: "HTTP" }
  # - { port: "443", proto: "tcp", comment: "HTTPS" }

# Rate limiting для SSH (защита от brute force)
ufw_rate_limit_ssh: true

# ==============================================================================
# Настройка Fail2ban
# ==============================================================================
# ВАЖНО: fail2ban_ignoreip определите здесь (не в .example!)
# Пример:
# fail2ban_ignoreip:
#   - "127.0.0.1/8"
#   - "::1"
#   - "ВАШ_ДОМАШНИЙ_IP"

fail2ban_maxretry: 5
fail2ban_findtime: 600                   # 10 минут
fail2ban_bantime: -1                     # Постоянный бан

# Настройки SSH jail
fail2ban_ssh_enabled: true
fail2ban_ssh_maxretry: 5
fail2ban_ssh_findtime: 120               # 2 минуты
fail2ban_ssh_bantime: -1                 # Постоянный бан

# Email уведомления fail2ban (требует настройки msmtp)
fail2ban_email_enabled: false            # Включить уведомления о банах
# fail2ban_destemail: "{{ notify_email }}"
# fail2ban_sender: "{{ smtp_email }}"

# ==============================================================================
# Автообновление системы
# ==============================================================================
# Расписание: день недели, час, минута
# По умолчанию: среда в 04:00
auto_update_weekday: "3"                 # 0=вс, 1=пн, 2=вт, 3=ср, 4=чт, 5=пт, 6=сб
auto_update_hour: "4"
auto_update_minute: "0"

# Автоперезагрузка после обновлений (если требуется)
auto_update_reboot: true
auto_update_reboot_time: "04:30"         # Время перезагрузки

# Удалять неиспользуемые пакеты и старые ядра
auto_update_remove_unused: true
auto_update_remove_unused_kernel: true

# Пакеты которые НЕ обновлять автоматически
auto_update_blacklist: []
# auto_update_blacklist:
#   - docker-ce
#   - kubelet

# ==============================================================================
# Настройка уведомлений (msmtp + login_notify)
# ==============================================================================
# ВАЖНО: Секретные данные храните в vault!
# Создайте: ansible-vault create group_vars/all/vault.yml
# И добавьте туда:
#   vault_smtp_email: "your-email@gmail.com"
#   vault_smtp_password: "xxxx-xxxx-xxxx-xxxx"
#   vault_notify_email: "alerts@gmail.com"

# Подключение переменных из vault:
# smtp_email: "{{ vault_smtp_email }}"
# smtp_password: "{{ vault_smtp_password }}"
# notify_email: "{{ vault_notify_email }}"

# Имя сервера в уведомлениях (используется в email)
server_name: "MY-VPS"

# SMTP настройки (Gmail по умолчанию)
smtp_host: "smtp.gmail.com"
smtp_port: 587

# Отправить тестовое письмо после настройки msmtp
msmtp_send_test_email: true

# Установить GeoIP для определения страны в уведомлениях о входе
login_notify_geoip: true

# ==============================================================================
# Системные настройки
# ==============================================================================
timezone: "UTC"
locale: "en_US.UTF-8"

# Пакеты для установки
common_packages:
  - curl
  - wget
  - vim
  - git
  - unzip
